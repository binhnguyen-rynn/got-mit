<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gọt Mít</title>
    <style>
        /* --- CSS --- */
        @import url('https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Roboto:wght@400;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f8ff;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        #game-container {
            position: relative;
            width: 900px;
            height: 700px;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- Màn hình bắt đầu --- */
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #fffbeb;
            z-index: 10;
        }

        h1 {
            font-family: 'Patrick Hand', cursive;
            font-size: 5rem;
            color: #d35400;
            margin-top: 20px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 0px #f1c40f;
        }

        .start-btn-container {
            position: relative;
            width: 300px;
            height: 300px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .start-btn-container:hover {
            transform: scale(1.05);
        }

        .start-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .start-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px black;
            font-family: 'Patrick Hand', cursive;
            pointer-events: none;
        }

        /* Meme vị trí */
        .meme-corner {
            position: absolute;
            width: 150px;
            height: auto;
        }
        .top-left { top: 20px; left: 20px; }
        .top-right { top: 20px; right: 20px; }
        .bottom-left { bottom: 20px; left: 20px; }
        .bottom-right { bottom: 20px; right: 20px; }

        /* --- Màn hình chơi game --- */
        #game-play-screen {
            display: none;
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* Khu vực hiển thị Mít và Nạo */
        .visual-area {
            height: 400px;
            width: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        .fruit-wrapper {
            position: relative;
            width: 400px;
            height: 300px; /* Tỉ lệ ảnh mít */
        }

        /* Lớp mít đã bóc (ẩn bên dưới) */
        .peeled-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('589897348_1191331483096498_7699021807084570458_n.png');
            background-size: 100% 100%;
            background-repeat: no-repeat;
        }

        /* Lớp vỏ mít (chia thành 10 phần) */
        .raw-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
        }

        .slice {
            flex: 1; /* Chia đều 10 phần */
            background-image: url('589646983_1948335472447220_7961946277988129556_n (1).png');
            background-size: 400px 300px; /* Kích thước bằng wrapper */
            background-repeat: no-repeat;
            /* background-position sẽ được set bằng JS */
            transition: opacity 0.5s;
        }

        /* Cái nạo */
        #peeler {
            position: absolute;
            width: 80px;
            height: auto;
            z-index: 5;
            top: -60px; /* Vị trí bắt đầu */
            transition: all 0.5s ease-in-out;
            cursor: pointer;
        }

        #peeler.clickable {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Khu vực câu hỏi */
        .question-area {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 20px;
            background-color: #fce4ec;
            border-top: 5px solid #e91e63;
            box-sizing: border-box;
            transform: translateY(100%); /* Ẩn ban đầu */
            transition: transform 0.3s;
        }

        .question-area.active {
            transform: translateY(0);
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .option-btn {
            padding: 15px;
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
        }

        .option-btn:hover {
            background-color: #f0f0f0;
            border-color: #bbb;
        }

        .option-btn.correct { background-color: #d4edda; border-color: #28a745; }
        .option-btn.wrong { background-color: #f8d7da; border-color: #dc3545; }

        /* --- Hiệu ứng Rơi (Thua) --- */
        .falling {
            animation: fallDown 1s forwards ease-in;
        }

        @keyframes fallDown {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(600px) rotate(45deg); opacity: 0; }
        }

        #fail-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            color: white;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
            text-align: center;
        }

        .retry-btn {
            margin-top: 20px;
            padding: 10px 30px;
            font-size: 1.5rem;
            background: #e91e63;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
        }

        /* --- Màn hình Thành công --- */
        #success-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, #fffacd 20%, #ffeb3b 100%);
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
        }

        .final-dish {
            width: 300px; /* Bắt đầu nhỏ */
            transition: width 2s ease-out;
            border-radius: 20px;
            box-shadow: 0 0 50px #ff9800;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px #ff9800; }
            to { box-shadow: 0 0 60px #ffeb3b, 0 0 20px white; }
        }

        .success-text {
            font-family: 'Patrick Hand', cursive;
            font-size: 4rem;
            color: #d35400;
            margin-top: 20px;
            opacity: 0;
            animation: fadeIn 2s forwards 1s;
        }

        @keyframes fadeIn { to { opacity: 1; } }

    </style>
</head>
<body>

    <div id="game-container">
        
        <audio id="sound-correct" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
        <audio id="sound-wrong" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
        <audio id="sound-peel" src="https://assets.mixkit.co/sfx/preview/mixkit-paper-slide-1530.mp3"></audio>
        <audio id="sound-win" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>

        <div id="start-screen">
            <img src="566556860_805605658780374_8685542069691118495_n.jpg" class="meme-corner top-left" alt="Meme 1">
            <img src="566339069_1287133253215885_4519683386272925514_n.jpg" class="meme-corner bottom-right" alt="Meme 2">
            
            <h1>Gọt Mít</h1>
            
            <div class="start-btn-container" onclick="startGame()">
                <img src="589646983_1948335472447220_7961946277988129556_n (1).png" class="start-img" alt="Quả mít">
                <div class="start-text">Bắt đầu</div>
            </div>
        </div>

        <div id="game-play-screen">
            <div class="visual-area">
                <div class="fruit-wrapper" id="fruit-wrapper">
                    <div class="peeled-layer"></div>
                    <div class="raw-layer" id="raw-layer"></div>
                    <img src="590419274_726862006561705_6337148499201091366_n (1).png" id="peeler" alt="Nạo">
                </div>
            </div>

            <div class="question-area" id="question-area">
                <div class="question-text" id="q-text">Câu hỏi ở đây...</div>
                <div class="options-grid" id="opt-grid">
                    </div>
            </div>
        </div>

        <div id="fail-screen">
            <img src="567123774_1558968145545942_2754862854628800996_n.jpg" style="width: 200px; border-radius: 10px; margin-bottom: 20px;" alt="Fail Meme">
            <h2>Bạn đã làm rơi mít!</h2>
            <p>Vui lòng gọt mít cẩn thận hơn.</p>
            <button class="retry-btn" onclick="retryLevel()">Quay lại</button>
        </div>

        <div id="success-screen">
            <img src="554667663_1806783209946881_9027387926384437070_n.jpg" class="meme-corner top-left" alt="Win Meme 1">
            <img src="575455640_1897000301166016_3057523793737663854_n.jpg" class="meme-corner bottom-right" alt="Win Meme 2">
            
            <img src="589897348_1191331483096498_7699021807084570458_n.png" class="final-dish" id="final-dish" alt="Đĩa mít">
            <div class="success-text">Tuyệt vời! Mời bạn xơi!</div>
        </div>

    </div>

    <script>
        // --- DỮ LIỆU CÂU HỎI ---
        const questions = [
            { q: "Tín hiệu tương tự là gì?", options: ["A. Tín hiệu chỉ nhận một số giá trị rời rạc", "B. Tín hiệu biến thiên liên tục theo thời gian", "C. Tín hiệu chỉ có hai mức 0 và 1", "D. Tín hiệu không thay đổi theo thời gian"], ans: 1 },
            { q: "Đại lượng nào sau đây là ví dụ của tín hiệu tương tự?", options: ["A. Dãy bit trong máy tính", "B. Nhịp nháy của đèn LED", "C. Sóng âm khi nói chuyện", "D. Dữ liệu mã hóa nhị phân"], ans: 2 },
            { q: "Đặc điểm của tín hiệu tương tự là:", options: ["A. Không bị nhiễu trong truyền tải", "B. Có vô số giá trị biên độ", "C. Chỉ có 2 mức tín hiệu", "D. Không thể bị biến dạng"], ans: 1 },
            { q: "Trong truyền thông, nhược điểm lớn nhất của tín hiệu tương tự là:", options: ["A. Khó lưu trữ", "B. Dễ bị nhiễu và méo tín hiệu", "C. Tốc độ truyền thấp", "D. Chỉ truyền được trong khoảng cách ngắn"], ans: 1 },
            { q: "Biên độ của tín hiệu tương tự là:", options: ["A. Số mức rời rạc của điện áp", "B. Mức cao nhất – thấp nhất mà tín hiệu đạt được", "C. Tốc độ biến thiên theo thời gian", "D. Tần số của tín hiệu"], ans: 1 },
            { q: "Tín hiệu âm thanh trong loa là tín hiệu:", options: ["A. Tương tự", "B. Số", "C. Vừa tương tự vừa số", "D. Không phải là tín hiệu"], ans: 0 },
            { q: "Vì sao tín hiệu tương tự dễ bị nhiễu?", options: ["A. Vì chỉ có hai mức 0 và 1", "B. Vì biến thiên liên tục nên tác động nhỏ đều làm thay đổi tín hiệu", "C. Vì được số hóa", "D. Vì tốc độ truyền quá cao"], ans: 1 },
            { q: "Âm lượng tai nghe tăng giảm liên tục là ví dụ của tín hiệu tương tự vì:", options: ["A. Âm lượng chỉ có 2 mức", "B. Âm lượng thay đổi theo từng nấc rời rạc", "C. Âm lượng biến thiên liên tục theo mức người dùng vặn", "D. Tai nghe chỉ phát tín hiệu số"], ans: 2 },
            { q: "Micro thu âm dễ bị nhiễu (tiếng gió, tiếng quạt) vì:", options: ["A. Micro hoạt động bằng tín hiệu số", "B. Micro không thu được dao động nhỏ", "C. Tín hiệu âm là tín hiệu liên tục và mọi dao động nhỏ đều được thu vào", "D. Micro có độ trễ"], ans: 2 },
            { q: "Sóng radio AM được xem là tín hiệu tương tự vì:", options: ["A. Biên độ sóng thay đổi liên tục để mang thông tin", "B. Tần số sóng được mã hóa rời rạc", "C. Tín hiệu chỉ có 0 và 1", "D. Tất cả sai"], ans: 0 }
        ];

        // --- BIẾN TRẠNG THÁI ---
        let currentQuestionIdx = 0;
        let isPeelerActive = false; // Trạng thái chờ click vào nạo
        const totalSlices = 10;
        
        // --- DOM ELEMENTS ---
        const peeler = document.getElementById('peeler');
        const rawLayer = document.getElementById('raw-layer');
        const questionArea = document.getElementById('question-area');
        const fruitWrapper = document.getElementById('fruit-wrapper');

        // --- KHỞI TẠO GAME ---
        function initGame() {
            // Tạo 10 miếng vỏ mít
            rawLayer.innerHTML = '';
            for (let i = 0; i < totalSlices; i++) {
                let slice = document.createElement('div');
                slice.classList.add('slice');
                slice.id = `slice-${i}`;
                // Cắt ảnh background cho từng miếng
                // Vì flex chia đều, ta chỉ cần chỉnh background-position-x
                // slice 0 (trái) -> 0%, slice 9 (phải) -> 100%
                let pos = (i / (totalSlices - 1)) * 100;
                slice.style.backgroundPositionX = `${pos}%`;
                rawLayer.appendChild(slice);
            }
        }

        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-play-screen').style.display = 'block';
            initGame();
            prepareRound();
        }

        // --- LOGIC VÒNG CHƠI ---
        function prepareRound() {
            // Reset UI
            questionArea.classList.remove('active');
            
            // Tính vị trí nạo
            // Chúng ta gọt từ Phải sang Trái -> Bắt đầu từ slice 9 về 0
            let currentSliceIndex = (totalSlices - 1) - currentQuestionIdx;
            
            // Di chuyển nạo đến vị trí miếng mít hiện tại
            let sliceWidth = 400 / totalSlices; // 40px
            let leftPos = (currentSliceIndex * sliceWidth) + (sliceWidth/2) - (80/2); // Center peeler on slice
            
            peeler.style.left = `${leftPos}px`;
            peeler.style.top = '-60px'; // Reset độ cao
            peeler.style.transform = 'rotate(0deg)';

            // Bật trạng thái click cho nạo
            isPeelerActive = true;
            peeler.classList.add('clickable');
            peeler.onclick = onPeelerClick;
        }

        function onPeelerClick() {
            if (!isPeelerActive) return;
            isPeelerActive = false;
            peeler.classList.remove('clickable');
            peeler.onclick = null;

            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentQuestionIdx];
            document.getElementById('q-text').innerText = `Câu ${currentQuestionIdx + 1}: ${q.q}`;
            
            const grid = document.getElementById('opt-grid');
            grid.innerHTML = '';
            
            q.options.forEach((opt, idx) => {
                let btn = document.createElement('button');
                btn.classList.add('option-btn');
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(idx, btn);
                grid.appendChild(btn);
            });

            questionArea.classList.add('active');
        }

        function checkAnswer(selectedIdx, btnElement) {
            // Disable buttons
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);

            const correctIdx = questions[currentQuestionIdx].ans;

            if (selectedIdx === correctIdx) {
                // Đúng
                btnElement.classList.add('correct');
                document.getElementById('sound-correct').play();
                setTimeout(performPeelAction, 1000);
            } else {
                // Sai
                btnElement.classList.add('wrong');
                // Highlight đúng
                allBtns[correctIdx].classList.add('correct');
                document.getElementById('sound-wrong').play();
                setTimeout(performFailAction, 1000);
            }
        }

        // --- HÀNH ĐỘNG GỌT (ĐÚNG) ---
        function performPeelAction() {
            questionArea.classList.remove('active');
            
            // Âm thanh gọt
            document.getElementById('sound-peel').play();

            // 1. Nạo đi xuống
            peeler.style.top = '250px'; // Gọt xuống cuối quả

            // 2. Ẩn vỏ mít (Sau khi nạo đi qua một chút)
            setTimeout(() => {
                let currentSliceIndex = (totalSlices - 1) - currentQuestionIdx;
                let slice = document.getElementById(`slice-${currentSliceIndex}`);
                if (slice) slice.style.opacity = '0'; // Mất vỏ
            }, 300);

            // 3. Nạo đi lên và sang trái (chuẩn bị vòng sau)
            setTimeout(() => {
                peeler.style.top = '-60px';
                
                // Check win
                if (currentQuestionIdx === totalSlices - 1) {
                    setTimeout(finishGame, 1000);
                } else {
                    currentQuestionIdx++;
                    setTimeout(prepareRound, 600);
                }
            }, 800);
        }

        // --- HÀNH ĐỘNG RƠI (SAI) ---
        function performFailAction() {
            questionArea.classList.remove('active');
            
            // Hiệu ứng rơi cho cả quả mít và nạo
            fruitWrapper.classList.add('falling');
            
            setTimeout(() => {
                document.getElementById('fail-screen').style.display = 'flex';
            }, 1000);
        }

        function retryLevel() {
            document.getElementById('fail-screen').style.display = 'none';
            fruitWrapper.classList.remove('falling');
            
            // Reset câu hỏi hiện tại để làm lại
            prepareRound(); 
        }

        // --- KẾT THÚC GAME ---
        function finishGame() {
            document.getElementById('game-play-screen').style.display = 'none';
            const successScreen = document.getElementById('success-screen');
            successScreen.style.display = 'flex';
            
            document.getElementById('sound-win').play();

            // Phóng to đĩa mít
            setTimeout(() => {
                document.getElementById('final-dish').style.width = "600px"; // Phóng to dần
            }, 100);
        }

    </script>
</body>

</html>
